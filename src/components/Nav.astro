<nav
  id="nav"
  class="fixed bottom-0 left-0 z-50 h-auto w-full bg-gradient-to-t from-[rgba(196,171,255,1)] to-transparent p-[var(--margin)] pb-4 transition-transform duration-600 ease-in-out"
>
  <div class="relative flex justify-center">
    <!-- Toggle Button -->
    <button
      id="menu-toggle"
      class="heading-2 z-50 mb-2 flex w-max items-center justify-center bg-black px-8 py-2 text-white shadow-2xl lg:hidden"
      aria-label="Toggle Menu"
    >
      <span id="menu-icon">Open Menu</span>
    </button>

    <!-- Menu Items -->
    <ul
      id="menu"
      class="menu-collapse absolute bottom-14 m-auto flex max-h-0 w-full flex-col items-center gap-4 overflow-hidden rounded-xl p-0 transition-all duration-500 ease-in-out lg:static lg:max-h-none lg:flex-row lg:justify-center lg:overflow-visible lg:bg-transparent lg:p-0"
    >
      <li class="pill">
        <a class="no-underline" href="#course-description">Course Description</a
        >
      </li>
      <li class="pill">
        <a class="no-underline" href="#module-1:-from-fixed-to-variable"
          >Course Modules</a
        >
      </li>
      <li class="pill">
        <a class="no-underline" href="#grading-and-attendance">Grading</a>
      </li>
      <li class="pill">
        <a class="no-underline" href="#open-source-policies">Policies</a>
      </li>
      <li class="pill">
        <a
          class="no-underline"
          href="#pratt-communications-design-departmental-resources"
          >Resources</a
        >
      </li>
    </ul>
  </div>
</nav>

<script>
  const toggleBtn = document.getElementById("menu-toggle");
  const menu = document.getElementById("menu");
  const icon = document.getElementById("menu-icon");

  toggleBtn.addEventListener("click", () => {
    menu.classList.toggle("open");
    icon.textContent =
      icon.textContent === "Open Menu" ? "Close Menu" : "Open Menu";
  });

  // Auto close menu when a pill is clicked (on mobile)
  document.querySelectorAll(".pill a").forEach((link) => {
    link.addEventListener("click", () => {
      if (window.innerWidth < 1024 && menu.classList.contains("open")) {
        menu.classList.remove("open");
        icon.textContent = "Open Menu";
      }
    });
  });

  // Random rotation per pill
  document.querySelectorAll(".pill").forEach((pill) => {
    const angle = (Math.random() * 4 - 2).toFixed(2);
    pill.style.transition = "transform 0.2s ease";
    pill.addEventListener("mouseenter", () => {
      pill.style.transform = `rotate(${angle}deg)`;
    });
    pill.addEventListener("mouseleave", () => {
      pill.style.transform = "";
    });
  });

  let lastScrollY = document.body.scrollTop;
  const nav = document.getElementById("nav");

  document.body.addEventListener("scroll", () => {
    const currentScrollY = document.body.scrollTop;

    if (currentScrollY > lastScrollY && currentScrollY > 50) {
      nav.classList.add("translate-y-full");
    } else {
      nav.classList.remove("translate-y-full");
    }

    lastScrollY = currentScrollY;
  });
</script>
